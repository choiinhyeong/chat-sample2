"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[9],{17009:function(e,s,n){n.r(s),n.d(s,{default:function(){return Ye}});var a=n(66252),o=n(3577),t=n(49963);const l={class:"kb-cloud",id:"kb-cloud"},c={class:"cloud-container",id:"cloud-now"},i={class:"cloud-wrapper"},u={class:"cloud-header"},r={class:"header-column header-title"},d=(0,a._)("h2",{class:"title"},"클라우드",-1),v=[d],p=(0,a._)("div",{class:"badge-on"},"ON",-1),m=(0,a._)("div",{class:"header-column header-subtitle"},null,-1),h={class:"header-column header-util"},w=(0,a._)("div",{class:"util-status"},null,-1),g={class:"util-my"},_={class:"text"},f={class:"my-avatar"},y={class:"cloud-body"},C={class:"cloud-player"},b={class:"player-main"},k={class:"main-viewport"},I={class:"viewport-header"},S={class:"header-column header-views"},H=(0,a._)("i",{class:"icon-eye"},null,-1),T={class:"text"},x=(0,a._)("div",{class:"header-column header-actions"},[(0,a._)("button",{class:"btn-viewport"},[(0,a._)("i",{class:"icon-viewport"})])],-1),D={class:"viewport-video"},L={key:2,src:"https://zep.us/play/8jd49y",width:"100%",height:"584px"},M={class:"main-actions"},N={key:0,class:"menu-buttons"},P={class:"menu-list"},Z=(0,a._)("i",{class:"icon-menu-lecture"},null,-1),q=(0,a._)("span",{class:"text"},"강의",-1),F=[Z,q],j=(0,a.uE)('<div class="dropdown-target"><div class="dropdown-box"><article class="dropdown-option-group"><h4 class="option-group-title">학습관리</h4><ul class="dropdown-option-list"><li class="dropdown-option-item"><a href="" class="dropdown-option-link">학습시작</a></li><li class="dropdown-option-item"><a href="" class="dropdown-option-link">학습종료</a></li><li class="dropdown-option-item"><a href="" class="dropdown-option-link">휴식시작</a></li><li class="dropdown-option-item"><a href="" class="dropdown-option-link">휴식종료</a></li><li class="dropdown-option-item"><a href="" class="dropdown-option-link">학습종료 취소</a></li><li class="dropdown-option-item"><a href="" class="dropdown-option-link">학습종료 확인</a></li></ul></article></div></div>',1),E=(0,a._)("i",{class:"icon-menu-display"},null,-1),V=(0,a._)("span",{class:"text"},"방송",-1),z=[E,V],U=(0,a._)("i",{class:"icon-menu-display"},null,-1),A=(0,a._)("span",{class:"text"},"화상",-1),Q=[U,A],K=(0,a._)("i",{class:"icon-menu-attendance"},null,-1),O=(0,a._)("span",{class:"text"},"ZEP",-1),R=[K,O],Y=(0,a.uE)('<li class="menu-item"><button class="btn-menu"><i class="icon-menu-quiz"></i><span class="text">퀴즈・투표</span></button></li><li class="menu-item"><button class="btn-menu"><i class="icon-menu-event"></i><span class="text">이벤트・쿠폰</span></button></li><li class="menu-item"><button class="btn-menu"><i class="icon-menu-qna"></i><span class="text">Q&amp;A・공지</span></button></li>',3),B=(0,a.uE)('<ul class="menu-list"><li class="menu-item"><button class="btn-menu"><i class="icon-menu-faq"></i><span class="text">FAQ</span></button></li><li class="menu-item"><button class="btn-menu"><i class="icon-menu-learners"></i><span class="text">학습인원</span></button></li></ul>',1),$={class:"action-buttons"},G=(0,a._)("button",{class:"btn-reconnect"},[(0,a._)("i",{class:"icon-reconnect"}),(0,a._)("span",{class:"text"},"재접속")],-1),W=(0,a._)("i",{class:"icon-exit"},null,-1),J=(0,a._)("span",{class:"text"},"종료",-1),X=[W,J],ee={class:"player-aside"},se={class:"aside-chat-container"},ne={class:"chat-screen"},ae={class:"chat-screen-messages",ref:"chatScreenEl"},oe={class:"chat-write"},te={class:"chat-write-options"},le=(0,a.uE)('<div class="option-column"><button class="btn-emoji"><i class="icon-emoji"></i></button><button class="btn-file"><i class="icon-file"></i></button></div>',1),ce={key:0,class:"option-column"},ie=(0,a._)("i",{class:"icon-menu"},null,-1),ue=[ie],re={class:"dropdown-target"},de={class:"dropdown-box"},ve={class:"dropdown-option-list"},pe={class:"dropdown-option-item"},me={class:"chat-write-forms"},he=(0,a._)("span",{class:"text"},"전송",-1),we=[he];function ge(e,s,n,d,Z,q){const E=(0,a.up)("ChatProfileImage"),V=(0,a.up)("CloudNowTeacherQuestion"),U=(0,a.up)("LiveCast"),A=(0,a.up)("CloudOnLiveConference"),K=(0,a.up)("ChatMessage");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",c,[(0,a._)("div",i,[(0,a._)("header",u,[(0,a._)("div",r,[(0,a._)("a",{href:"javascript:",onClick:s[0]||(s[0]=(...e)=>d.menuCompHideFunc&&d.menuCompHideFunc(...e))},v),p]),m,(0,a._)("div",h,[w,(0,a._)("div",g,[(0,a._)("span",_,(0,o.zw)(d.userInfo.lrnerNm),1),(0,a._)("div",f,[(0,a.Wm)(E,{target:d.userInfo.lrnerId},null,8,["target"])])])])]),(0,a._)("div",y,[d.showTeacherQstnComp?((0,a.wg)(),(0,a.j4)(V,{key:0})):(0,a.kq)("",!0),(0,a._)("div",C,[(0,a._)("div",b,[(0,a._)("div",k,[(0,a._)("div",I,[(0,a._)("div",S,[H,(0,a._)("span",T,(0,o.zw)(d.connUserCnt),1)]),x]),(0,a._)("div",D,[d.isLiveCastShow?((0,a.wg)(),(0,a.j4)(U,{key:0,"access-type":d.userInfo.accessType,"user-info":d.userInfo},null,8,["access-type","user-info"])):(0,a.kq)("",!0),d.onLiveConfShow?((0,a.wg)(),(0,a.j4)(A,{key:1,"access-type":d.userInfo.accessType,"user-info":d.userInfo},null,8,["access-type","user-info"])):(0,a.kq)("",!0),d.isIframeShow?((0,a.wg)(),(0,a.iD)("iframe",L)):(0,a.kq)("",!0)])]),(0,a._)("div",M,["full-access"===d.userInfo.accessType?((0,a.wg)(),(0,a.iD)("div",N,[(0,a._)("ul",P,[(0,a._)("li",{class:(0,o.C_)(["menu-item dropdown",{"is-active":d.showLectureMenu}])},[(0,a._)("button",{class:(0,o.C_)(["btn-menu",{"is-active":d.showLectureMenu}]),onClick:s[1]||(s[1]=e=>d.toggleMenu("lecture"))},F,2),j],2),(0,a._)("li",{class:(0,o.C_)("menu-item "+(d.isLiveCastShow?"is-active":""))},[(0,a._)("button",{onClick:s[2]||(s[2]=e=>d.connectCastFunc("cast")),class:"btn-menu"},z)],2),(0,a._)("li",{class:(0,o.C_)("menu-item "+(d.isLiveConfShow?"is-active":""))},[(0,a._)("button",{onClick:s[3]||(s[3]=e=>d.connectCastFunc("conf")),class:"btn-menu"},Q)],2),(0,a._)("li",{class:(0,o.C_)("menu-item "+(d.isIframeShow?"is-active":""))},[(0,a._)("button",{onClick:s[4]||(s[4]=e=>d.connectCastFunc("zep")),class:"btn-menu"},R)],2),Y]),B])):(0,a.kq)("",!0),(0,a._)("div",$,[G,(0,a._)("button",{class:"btn-exit",onClick:s[5]||(s[5]=(...e)=>d.sendDisconnect&&d.sendDisconnect(...e))},X)])])]),(0,a._)("div",ee,[(0,a._)("div",se,[(0,a._)("div",ne,[(0,a._)("ul",ae,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.msgArr,((e,s)=>((0,a.wg)(),(0,a.j4)(K,{key:s,type:e.type,message:e.message,"lrner-id":e.lrnerId,"lrner-name":e.lrnerNm,"send-date":e.sendDate},null,8,["type","message","lrner-id","lrner-name","send-date"])))),128))],512)]),(0,a._)("div",oe,[(0,a._)("div",te,[le,"full-access"!==d.userInfo.accessType?((0,a.wg)(),(0,a.iD)("div",ce,[(0,a._)("div",{class:(0,o.C_)(["option-menu dropdown",{"is-active":d.showTeacherQstnMenu}])},[(0,a._)("button",{class:"btn-menu",onClick:s[6]||(s[6]=e=>d.toggleMenu("teacher"))},ue),(0,a._)("div",re,[(0,a._)("div",de,[(0,a._)("ul",ve,[(0,a._)("li",pe,[(0,a._)("a",{href:"javascript:",onClick:s[7]||(s[7]=(...e)=>d.showTeacherQstnCompFunc&&d.showTeacherQstnCompFunc(...e)),class:"dropdown-option-link"},"강사님께 질문하기")])])])])],2)])):(0,a.kq)("",!0)]),(0,a._)("div",me,[(0,a.wy)((0,a._)("input",{type:"text",placeholder:"메시지 입력","onUpdate:modelValue":s[8]||(s[8]=e=>d.inputMessage=e),onKeyup:s[9]||(s[9]=(0,t.D2)(((...e)=>d.sendMessage&&d.sendMessage(...e)),["enter"]))},null,544),[[t.nr,d.inputMessage]]),(0,a._)("button",{class:"btn-write",onClick:s[10]||(s[10]=(...e)=>d.sendMessage&&d.sendMessage(...e))},we)])])])])])])])])])}n(82801);var _e=n(2262),fe=n(9367),ye=n(33907),Ce=n(6315),be=n(42119),ke=n(4252),Ie=n(54977),Se=n(64761),He=n(89464),Te=n(80703);const xe=e=>((0,a.dD)("data-v-49308508"),e=e(),(0,a.Cn)(),e),De={class:"container flex column"},Le={class:"flex row"},Me={class:"media-list",style:{width:"100%",display:"flex","flex-direction":"row","flex-wrap":"wrap"}},Ne={key:0,class:"media-block"},Pe={class:"participant-id"},Ze=xe((()=>(0,a._)("div",{class:"local-container"},null,-1))),qe=["id"],Fe={class:"participant-id"};function je(e,s,n,t,l,c){const i=(0,a.up)("voice-meter"),u=(0,a.up)("remote-video");return(0,a.wg)(),(0,a.iD)("div",De,[(0,a._)("div",Le,[(0,a._)("div",Me,[t.localMedia?((0,a.wg)(),(0,a.iD)("div",Ne,[(0,a._)("div",Pe,(0,o.zw)(n.userInfo.deptNm)+" "+(0,o.zw)(n.userInfo.lrnerNm)+" "+(0,o.zw)(t.myId),1),Ze])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.remoteParticipants,((e,s)=>((0,a.wg)(),(0,a.iD)("div",{class:"media-block",key:s,id:e.participant.id},[(0,a._)("div",Fe,(0,o.zw)(e.participant.lrnerNm)+" "+(0,o.zw)(e.participant.id),1),(0,a.Wm)(i,{level:e.level},null,8,["level"]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.videos,((e,s)=>((0,a.wg)(),(0,a.j4)(u,{key:s,autoplay:"",remoteVideo:e},null,8,["remoteVideo"])))),128))],8,qe)))),128))])])])}var Ee=n(69755),Ve=n(94572),ze=n(19832),Ue={name:"CloudOnLiveConference",props:{accessType:String,userInfo:{type:Object}},components:{voiceMeter:Ee.Z,remoteVideo:Ve.Z},setup(e){const s=(0,_e.iH)(e.userInfo.channelNo+"-on-conf"),n=(0,_e.iH)(null),o=(0,_e.iH)(null),t=(0,_e.iH)(null),l=(0,_e.iH)([]),c=(0,_e.iH)(!1),i=(0,_e.iH)(""),u=(0,_e.iH)([]),r=(0,_e.iH)(-1),d=()=>{console.log(n.value,"init====>",e.userInfo),null===n.value&&("full-access"===e.accessType?p():setTimeout((()=>{p()}),3e3))};(0,a.bv)((()=>{console.log("mounted===>",n.value),d()})),(0,a.Ah)((()=>{w()}));const v=async()=>{await ze.Z.signIn({serviceId:"2022KBH0C8AZ",serviceKey:"2022KBH0C8AZ42PO",secret:"w7kvrnnCNVjBzjdR"})},p=async()=>{await v(),await m(),await h(),await n.value.connect(s.value),i.value=n.value.localParticipant.id,c.value=!0,n.value.publish([o.value]),r.value=window.setInterval((()=>{const e=n.value.getRemoteAudioLevels();e.remoteParticipants.forEach((e=>{const s=l.value.find((s=>s.participant.id===e.remoteParticipant.id));let n=parseFloat(e.level.toFixed(3));n>.15&&(n=.15),s.level=n/.15*100}))}),250)},m=async()=>{o.value=await ze.Z.createLocalMedia({audio:!0,video:!0}),(0,a.Y3)((async()=>{const e=o.value.video.attach();e.className="local-video",e.style.width="100%",document.querySelector(".local-container").appendChild(e),u.value=await o.value.getCameraDevices()}))},h=async()=>{n.value=ze.Z.createConference(),n.value.on("connected",(e=>{e.remoteParticipants.forEach((async e=>{let s=[];const a=e.getUnsubscribedVideos();if(a.length){const e=a.map((e=>{e.getVideoId()}));s=await n.value.subscribe(e)}console.log("connected===================><<<<<<<<<<<<<<<<<<",e),l.value.push({participant:e,videos:s,level:0})}))})),n.value.on("participantEntered",(e=>{console.log("participantEntered===================>",e),l.value.push({participant:e.remoteParticipant,videos:[],level:0})})),n.value.on("participantLeft",(e=>{const s=l.value.findIndex((s=>s.participant.id===e.remoteParticipantId));l.value.splice(s,1)})),n.value.on("remoteVideoPublished",(async s=>{console.log("remoteVideoPublished===============================>",s);const a=await n.value.subscribe([s.remoteVideo.videoId]);if(a.length){const n=l.value.find((e=>e.participant.id===s.remoteParticipant.id));n&&(n.videos=n.videos.concat(a),n.lrnerNm=e.userInfo.lrnerNm)}})),n.value.on("remoteVideoUnpublished",(e=>{const s=l.value.find((s=>s.participant.id===e.remoteParticipant.id));s&&(s.videos=s.videos.filter((s=>s.videoId!==e.remoteVideo.videoId)))}))},w=async()=>{n.value.disconnect(),o.value.stop(),o.value.video.detach(),o.value=null,t.value&&(t.value.stop(),t.value.video.detach(),t.value=null),c.value=!1,i.value="",l.value=[],window.clearInterval(r.value),r.value=-1,ze.Z.signOut()},g=async()=>{t.value=await ze.Z.createLocalScreen({audio:!0,video:!0}),t.value.video.setExtraValue("screen");const e=t.value.video.attach();e.className="local-video",e.style.width="100%",document.querySelector(".local-container").appendChild(e),n.value.publish([t.value])},_=async()=>{t.value.video.detach(),t.value.stop(),n.value.unpublish([t.value]),t.value=void 0};return{confName:s,conf:n,localMedia:o,localScreen:t,remoteParticipants:l,isConnected:c,myId:i,cameraDevices:u,audioCheckInterval:r,onConnect:p,onProvisioning:v,onCreateLocalMedia:m,onCreateLocalScreen:g,onCreateConference:h,onDisConnectConference:w,onDestroyLocalScreen:_}}},Ae=n(83744);const Qe=(0,Ae.Z)(Ue,[["render",je],["__scopeId","data-v-49308508"]]);var Ke=Qe,Oe={name:"CloudOn",components:{CloudOnLiveConference:Ke,CloudNowTeacherQuestion:Te.Z,LiveCast:He.Z,ChatProfileImage:Se.Z,ChatMessage:ke.Z},setup(){const e=(0,ye.oR)();let s="";s="localhost:3000";let n=(0,fe.ZP)(s,{transports:["websocket"],path:"/websocket/chat"}),o=(0,fe.ZP)(s,{transports:["websocket"],path:"/websocket/system"});const t=(0,_e.iH)(),l=(0,_e.iH)([]),c=(0,_e.iH)(!1),i=(0,_e.iH)(!1),u=(0,_e.iH)(!1),r=(0,_e.iH)(),d=(0,_e.iH)(!1),v=(0,_e.iH)(!1),p=(0,_e.iH)(!1),m=(0,_e.iH)(!1),h=(0,_e.iH)({}),w=(0,_e.iH)(0);(0,a.bv)((()=>{console.log("onMounted====>",n.connected,",",o.connected),document.body.classList.add("notscroll"),H.query.params?(h.value=JSON.parse(decodeURIComponent(atob(H.query.params))),g()):console.log("재접속 해주세요.")})),(0,a.Ah)((()=>{console.log("onUnmounted====>",n.connected,",",o.connected),(n.connected||o.connected)&&(n.disconnect(),o.disconnect()),d.value=!1,p.value=!1,v.value=!1}));const g=()=>{h.value.sendType="",h.value.message="",h.value.messageType="",h.value.socketId="",h.value.socketId2="",h.value.channelNo="channel1",h.value.accessType="viewer","S017330"===h.value.lrnerId&&(h.value.accessType="full-access"),h.value.isCast=!1,h.value.isConf=!1,n.emit("chat_channel_connection",h.value),o.emit("domSocket_channel_connection",h.value)},_=()=>{void 0!==t.value&&""!==t.value&&(h.value.sendType="message",h.value.message=t.value,t.value="",n.emit("message",h.value))},f=()=>{console.log("sendDisconnect =======> "),h.value.sendType="disconnect",d.value=!1,p.value=!1,v.value=!1,n.disconnect(),o.disconnect()};n.on("chat_channel_connection",(e=>{console.log("chat connection success ========> ",e),h.value.socketId=e.socketId;let s=e.lrnerNm,n=s+"님이 현재 참여하셨습니다.",a=(0,Ie.KG)(e.connectDate,"(A) hh:mm");l.value.push({type:"",message:n,lrnerId:e.lrnerId,lrnerNm:s,sendDate:a}),I()})),n.on("message",(e=>{console.log("chat messsage===>",e);let s="",n=e.lrnerNm;e.lrnerId===h.value.lrnerId&&(s="my",n="");let a=(0,Ie.KG)(e.connectDate,"(A) hh:mm");l.value.push({type:s,message:e.message,lrnerId:e.lrnerId,lrnerNm:n,sendDate:a})})),n.on("disconnect",(e=>{console.log("disconnect ========> ",e),I()})),n.on("disconnectCustom",(e=>{console.log("disconnectCustom ========> ",e)})),o.on("domSocket_channel_connection",(e=>{console.log("domSocket connection success ========> ",e.socketId2),h.value.socketId2=e.socketId2})),o.on("disconnect",(()=>{console.log("domSocket disconnect ========> ")})),o.on("disconnectCustom",(()=>{console.log("domSocket disconnectCustom ========> ")})),o.on("message",(e=>{console.log("domSocket message ========> ",e.messageType),"liveCast"===e.messageType?d.value?d.value=!1:d.value=!0:"liveConf"===e.messageType&&(v.value?v.value=!1:v.value=!0)}));const y=e=>{h.value.sendType="message","cast"===e?(h.value.messageType="liveCast",o.emit("message",h.value)):"conf"===e?(h.value.messageType="liveConf",o.emit("message",h.value)):"zep"===e&&(m.value?m.value=!1:m.value=!0)},C=e=>{"lecture"===e?c.value=!c.value:"teacher"===e&&(i.value=!i.value)},b=()=>{u.value=!u.value},k=()=>{c.value=!1,i.value=!1,u.value=!1},I=()=>{e.dispatch(`users/${Ce.qU}`,h.value.channelNo).then((e=>{console.log("getRedisUsersList====>",e),200===e.status&&console.log("status 200 ==> ",w.value)})).catch((e=>{console.error(e)}))},S=()=>{e.dispatch(`users/${Ce.lr}`,localStorage.getItem("info")).then((e=>{e.status})).catch((e=>{console.error(e)}))},H=(0,be.yj)(),T=()=>{e.dispatch(`users/${Ce.Zv}`,{accTy:"admin",userSn:"65795",lrnerId:"S017347",lrnerNm:"김상민",deptCd:"",deptNm:""}).then((e=>{200===e.status&&(H.params.encrypt=e.data)})).catch((e=>{console.error(e),alert("창을 닫고 재접속 해주세요.")}))};return{inputMessage:t,userInfo:h,chatScreenEl:r,msgArr:l,isLiveCastShow:d,onLiveConfShow:v,isLiveConfShow:p,isIframeShow:m,showLectureMenu:c,showTeacherQstnMenu:i,showTeacherQstnComp:u,connUserCnt:w,sendMessage:_,sendDisconnect:f,getUsersEncryptFunc:T,getUsersDecryptFunc:S,getRedisUsersList:I,connectCastFunc:y,showTeacherQstnCompFunc:b,toggleMenu:C,menuCompHideFunc:k}}};const Re=(0,Ae.Z)(Oe,[["render",ge]]);var Ye=Re}}]);
//# sourceMappingURL=9.3d699549.js.map